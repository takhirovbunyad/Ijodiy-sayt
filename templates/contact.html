{% load static %}

<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bog'lanish</title>
  <link rel="stylesheet" href="{% static 'css/contact.css' %}" />
  <meta name="description" content="Biz bilan bog'laning: telefon, email, ijtimoiy tarmoqlar va xabar yuborish formasi." />
</head>

<body>
  <img id="hamburger" class="hamburger-icon" src="https://www.svgrepo.com/show/506247/menu-vertical.svg" alt="Menu" />
  {% include "sidebar.html" %}
  {% include "loader.html" %}
  <main class="contact-page">
    <section class="contact-main">
      <div class="header">
        <h1>Biz bilan bog'laning</h1>
      </div>

      <p class="lead">Savol va takliflaringizni qoldiring.</p>

      <!-- Kontakt kartalari -->
      <div class="contact-cards">
        <div class="card phone">
          <div class="label">Telefon</div>
          <div class="value">
            {% if request.user.is_authenticated and request.user.profile.phone_number %}
              <a href="tel:{{ request.user.profile.phone_number }}">{{ request.user.profile.phone_number }}</a>
            {% else %}
              <a href="tel:+998994182515">+998 99 418 25 15</a>
            {% endif %}
          </div>
        </div>

        <div class="card email">
          <div class="label">Email</div>
          <div class="value">
            {% if request.user.is_authenticated and request.user.email %}
              <a href="mailto:{{ request.user.email }}">{{ request.user.email }}</a>
            {% else %}
              <a href="mailto:test@example.com">test@example.com</a>
            {% endif %}
          </div>
        </div>

        <div class="card socials">
          <div class="label">Ijtimoiy tarmoqlar</div>
          <div class="social-links">
            {% if request.user.is_authenticated and request.user.profile.telegram %}
              <a href="{{ request.user.profile.telegram }}" class="tg" target="_blank">Telegram</a>
            {% endif %}
            {% if request.user.is_authenticated and request.user.profile.instagram %}
              <a href="{{ request.user.profile.instagram }}" class="ig" target="_blank">Instagram</a>
            {% endif %}
            {% if request.user.is_authenticated and request.user.profile.tiktok %}
              <a href="{{ request.user.profile.tiktok }}" class="tt" target="_blank">TikTok</a>
            {% endif %}
            {% if request.user.is_authenticated and request.user.profile.youtube %}
              <a href="{{ request.user.profile.youtube }}" class="yt" target="_blank">YouTube</a>
            {% endif %}
            {% if request.user.is_authenticated and request.user.profile.linkedin %}
              <a href="{{ request.user.profile.linkedin }}" class="in" target="_blank">LinkedIn</a>
            {% endif %}
            {% if request.user.is_authenticated and request.user.profile.github %}
              <a href="{{ request.user.profile.github }}" class="gh" target="_blank">GitHub</a>
            {% endif %}
          </div>
        </div>

        <div class="card address">
          <div class="label">Manzil</div>
          <div class="value">
            {% if request.user.is_authenticated and request.user.profile.address %}
              {{ request.user.profile.address }}
            {% else %}
              Manzil kiritilmagan
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Xabar yuborish formasi -->
      <form id="contactForm" action="{% url 'contact' %}" method="post" novalidate>
        {% csrf_token %}
        {% if request.user.is_authenticated %}
          <input type="hidden" name="sender_name" value="{{ request.user.get_full_name|default:request.user.username }}">
          <input type="hidden" name="sender_email" value="{{ request.user.email }}">
        {% else %}
          <div class="field">
            <label for="name">Ism va Familiya</label>
            <input id="name" name="sender_name" type="text" placeholder="Ismingiz" required />
          </div>
          <div class="field">
            <label for="email">Email</label>
            <input id="email" name="sender_email" type="email" placeholder="you@example.com" required />
          </div>
        {% endif %}

        <div class="field">
          <label for="phone">Telefon (ixtiyoriy)</label>
          <input id="phone" name="sender_phone" type="tel" placeholder="+998901234567"
                 value="{% if request.user.is_authenticated %}{{ request.user.profile.phone_number }}{% endif %}">
        </div>

        <div class="field">
          <label for="message">Xabar</label>
          <textarea id="message" name="message" placeholder="XABARINGIZ EMAIL ORQALI YUBORILADI!" required></textarea>
        </div>

        <div class="actions">
          <button type="submit">Xabar yuborish</button>

        </div>
      </form>

      <!-- Egasi haqida -->
      <section class="owner-brief">
        <h2>Ega haqida</h2>
        <p>
          {% if request.user.is_authenticated and request.user.profile.bio %}
            {{ request.user.profile.bio|linebreaksbr }}
          {% else %}
            Bu yerda egasi haqida qisqacha ma'lumot ko‘rsatiladi — bio sahifasini to‘ldiring.
          {% endif %}
        </p>
      </section>

      <!-- Dasturchi bloki -->
      <footer class="developer">
        <div class="dev-info">
          <strong>Dasturchi</strong>
          <div>Telegram: <a href="https://t.me/tbunyod_dev" target="_blank">@tbunyod_dev</a></div>
        </div>
        <div class="copyright">© {{ now|date:"Y" }}</div>
      </footer>
    </section>

    <aside class="contact-side">
      <h3>Qo‘shimcha</h3>
      <dl>
        <dt>Ish vaqti</dt>
        <dd>kiritilmagan</dd>

        <dt>Ofis</dt>
        <dd>
          {% if request.user.is_authenticated and request.user.profile.address %}
            {{ request.user.profile.address }}
          {% else %}
            Toshkent, O‘zbekiston
          {% endif %}
        </dd>

        <dt>Qo‘llab-quvvatlash</dt>
        <dd>
          {% if request.user.is_authenticated and request.user.email %}
            <a href="mailto:{{ request.user.email }}">{{ request.user.email }}</a>
          {% else %}
            <a href="mailto:hello@example.com">hello@example.com</a>
          {% endif %}
        </dd>
      </dl>
    </aside>
  </main>

  <!-- ==========================
       SUCCESS / ERROR MODAL
       ========================== -->
  {% if messages %}
    {% for message in messages %}
      <div id="django-message" data-message="{{ message }}" data-level="{{ message.tags }}"></div>
    {% endfor %}
  {% endif %}

  <div class="modal-overlay" id="successModal" aria-hidden="true" role="dialog" aria-labelledby="modalTitle">
    <div class="modal-card" role="document">
      <button class="modal-close" id="modalClose" aria-label="Yopish">&times;</button>
      <div class="modal-illustration">✔</div>
      <h3 id="modalTitle">Xabaringiz yuborildi</h3>
      <p id="modalMessage">Rahmat! Tez orada javob beramiz.</p>
    </div>
  </div>

  <script src="{% static 'js/contact.js' %}"></script>
</body>
</html>
